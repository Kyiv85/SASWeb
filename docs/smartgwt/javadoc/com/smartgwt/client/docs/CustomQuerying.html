<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_17) on Tue May 18 08:30:57 EDT 2010 -->
<TITLE>
CustomQuerying
</TITLE>

<META NAME="date" CONTENT="2010-05-18">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CustomQuerying";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../com/smartgwt/client/docs/Cursor.html" title="interface in com.smartgwt.client.docs"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../com/smartgwt/client/docs/Data.html" title="interface in com.smartgwt.client.docs"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?com/smartgwt/client/docs/CustomQuerying.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CustomQuerying.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;METHOD</FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;METHOD</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.smartgwt.client.docs</FONT>
<BR>
Interface CustomQuerying</H2>
<HR>
<DL>
<DT><PRE>public interface <B>CustomQuerying</B></DL>
</PRE>

<P>
<h3>Custom Querying Overview</h3>
 The Smart GWT server provides a number of ways to let you customize the SQL or Hibernate&#010 query it generates to
 fetch data from or update your database.  You can provide full &#010 custom queries in either <CODE>'SQL'</CODE> or &#010 <CODE>'HQL'</CODE>, or you can replace individual parts of the query
 &#010 (<CODE>'the WHERE clause'</CODE>, for example) while
 letting&#010 Smart GWT generate the rest.  Full custom queries provide complete flexibility, but &#010 they cannot be
 used for automatic data paging; if you use a full custom query, all of its&#010 data will be returned to the client in
 one shot.  This may, of course, be perfectly &#010 reasonable, depending on the number of rows involved.  However, if
 you need automatic &#010 paging support, you should try to implement your customizations by replacing pieces of the&#010
 query.&#010 <p>&#010 Query customization is done per <A HREF="../../../../com/smartgwt/client/data/OperationBinding.html" title="class in com.smartgwt.client.data"><CODE>OperationBinding</CODE></A>, so it is
 entirely feasible to &#010 provide multiple custom queries for the same <A HREF="../../../../com/smartgwt/client/data/OperationBinding.html#getOperationType()"><CODE>'operation type'</CODE></A> &#010 on a given <A HREF="../../../../com/smartgwt/client/data/DataSource.html" title="class in com.smartgwt.client.data"><CODE>DataSource</CODE></A>.&#010&#010 <h4>Using criteria and values</h4>&#010 Whether using full custom
 queries or individual clauses, your code has access to the &#010 criteria values submitted with the operation; if this
 is an "add" or "update" operation,&#010 it also has access to the new field values sent from the client.&#010 <p>&#010
 Fields are accessed in your SQL or HQL code using the Velocity template language.  You&#010 can refer to container
 variables <b>$criteria</b> and <b>$values</b> in your queries or &#010 clause snippets, and Smart GWT will insert the
 appropriate values.  A simple &#010 <CODE>'whereClause'</CODE>
 example:&#010 <p>&#010 <code>&lt;whereClause&gt;continent = $criteria.continent AND population >
 $criteria.minPop&lt;/whereClause&gt;</code>&#010 <p>&#010 Please see <A HREF="../../../../com/smartgwt/client/docs/VelocitySupport.html" title="interface in com.smartgwt.client.docs"><CODE>VelocitySupport</CODE></A>
 for full details of accessing Smart GWT &#010 Server context variables using Velocity. &#010 &#010 <h4>Other template
 variables</h4>&#010 In addition to the Velocity template variables described above, we also provide a number of&#010
 template variables containing generally-useful values.  Please see&#010 <A HREF="../../../../com/smartgwt/client/docs/VelocitySupport.html" title="interface in com.smartgwt.client.docs"><CODE>VelocitySupport</CODE></A>
 for details.&#010&#010 <h4>Using the default clauses</h4>&#010 You also have access to the <CODE>com.smartgwt.client..DefaultQueryClause</CODE> generated by &#010 Smart GWT.  You can use these in full custom queries to
 allow a certain part of the query&#010 code to be generated:<p>&#010 <code>SELECT foo, bar FROM $defaultTableClause
 WHERE baz > $criteria.baz</code>.  &#010 <p>&#010 You can also use them, with care, as a foundation for your own
 additions:<p>&#010 <code>SELECT $defaultSelectClause, foo, bar FROM $defaultTableClause WHERE ($defaultWhereClause) AND
 baz > $criteria.baz</code>.&#010 <p>&#010 You can also use them within query snippets in the various subclause
 properties:<p>&#010 <code>&lt;selectClause&gt;$defaultSelectClause, foo, bar&lt;/selectClause&gt;</code>&#010&#010
 <h4>Stored procedures</h4>&#010 It is possible to include templated calls to SQL stored procedures in a&#010 <CODE>'customSQL'</CODE> clause, for the ultimate in flexibility.  For
 &#010 example, the deletion of an order might require a number of actions: deletion of the order&#010 record itself,
 messages sent to other systems (data warehousing, maybe, or a central accounts&#010 system running on a mainframe), an
 event log written, and so on.  You could write a stored &#010 procedure to do all this, and then invoke it with a
 customSQL clause:&#010 <pre>&#010    &lt;operationBinding operationType="remove"&gt;&#010        &lt;customSQL&gt;call
 deleteOrder($criteria.orderNo)&lt;customSQL&gt;&#010    &lt;/operationBinding&gt;&#010 </pre>&#010 <h4>Custom queries
 are safe</h4>&#010 Custom queries are protected from <a href=http://en.wikipedia.org/wiki/SQL_injection>&#010 SQL
 injection attacks</a>, because anything coming from the client is quoted and escaped &#010 in accordance with the syntax
 of the underlying database before use (though see the warning&#010 about using <code>$rawValue</code> in the article on
 <A HREF="../../../../com/smartgwt/client/docs/VelocitySupport.html" title="interface in com.smartgwt.client.docs"><CODE>VelocitySupport</CODE></A>).&#010 So, in a typical SQL injection attack an attacker might enter
 his User ID as <br>&#010 &nbsp;&nbsp;<code>123' OR '1' = '1</code><p>&#010 in the hope that this will generate a
 query&#010 with a where clause like this<br>&#010  &nbsp;&nbsp;<code>WHERE userID = '123' OR '1' = '1'</code><p>&#010
 which would of course return every row.  With Smart GWT custom queries, this does not happen; &#010 the client-provided
 string is escaped, and the resultant clause would look like this: <br>&#010 &nbsp;&nbsp;<code>WHERE userID = '123'' OR
 ''1'' = ''1'</code><p>&#010 This clause only returns those records where the userID column contains the literal value
 that &#010 the user typed: <br>&#010 &nbsp;&nbsp;<code>123' OR '1' = '1</code>&#010 <p>&#010 Further, custom queries can
 be protected from buggy or ad-hoc client requests because the &#010 query is specified on the server.  For example you
 could add a custom where clause, as shown&#010 in the above section on default clauses, to ensure that certain records
 are never seen by&#010 the client.  For instance: <p>&#010 <code>&lt;whereClause&gt;($defaultWhereClause) AND
 confidential = '0'&lt;/whereClause&gt;</code>.&#010&#010 <h4>Column case-sensitivity issues</h4>&#010 Different database
 products have different rules concerning case-sensitivity in column &#010 names.  Consider the following query:&#010
 <br><br><code>&nbsp;&nbsp;SELECT orderNumber FROM Order</code>&#010 <ul>&#010 <li>MySQL and Microsoft SQL Server are not
 case-sensitive with regard to column names, so &#010 this query will work whether the column is called "orderNumber" or
 "ORDERNUMBER" or any &#010 other variation.</li>&#010 <li>Oracle, HSQLDB and DB2 default to upper-case column names. 
 Therefore, this query will&#010 fail if the column is actually called "orderNumber"; it will only work if the
 underlying&#010 column name is "ORDERNUMBER"</li>&#010 <li>PostgreSQL defaults to lower-case column names, so this query
 will fail unless the &#010 underlying column name is actually "ordernumber"</li>&#010 </ul>&#010 These differences are
 one barrier to writing SQL that is portable from one database product&#010 to another.  There are two ways to work
 around them.&#010 <p>&#010 Firstly, you can simply accept the database's default behavior.  So, your table would &#010
 contain a column called "orderNumber" on MySQL, "ORDERNUMBER" on Oracle and "ordernumber"&#010 on PostgreSQL (note that
 you can still use mixed-case DataSource field names; Smart GWT&#010 will map DataSource field "orderNumber" to Oracle
 column "ORDERNUMBER" transparently). This&#010 is the simplest approach.&#010 <p>&#010 If you can't, or don't want to,
 accept the database default - if you are working with an&#010 existing schema, for example - then you will need to quote
 column names in your queries.&#010 Unfortunately, the way you do this also differs by database product, so quoting a
 column&#010 name correctly in one database's syntax will mean that the query cannot be ported to a&#010 different
 database without change.&#010 <p>&#010 To help with this case, we provide two extra container variables that you can
 use.&#010 <b>$fields</b> contains the names of all the fields in your DataSource, but quoted in&#010 accordance with the
 column-quoting rules of the target database.  <b>$qfields</b> also&#010 contains a list of field names, but in this case
 each one is qualified with its table&#010 name.<p>&#010 As an example of how to use <b>$fields</b> and <b>$qfields</b>,
 consider a DataSource with&#010 a field called "itemID", bound to a column also called "itemID", and a tableName
 property &#010 of "orderItem".  Here are three ways to write a <CODE>'selectClause'</CODE> &#010 for a custom SQL query that
 returns that field:<ul>&#010 <li><code>orderItem."itemID"</code>&#010 <li><code>orderItem.$fields.itemID</code>&#010
 <li><code>$qfields.itemID</code>&#010 </ul>&#010 The first of these is not portable.  It will work fine in HSQL and
 Oracle, but will fail &#010 with a syntax error in MySQL, amongst others, because you quote a field name with backticks
 &#010 in MySQL, not quote marks.&#010 <p>&#010 The usages via <b>$fields</b> and <b>$qfields</b> <em>are</em> portable. 
 The second line, &#010 when targeting Oracle, will be translated to <code>orderItem."itemID"</code>; when targeting&#010
 MySQL, it will be translated to <code>orderItem.itemID</code>, or <code>orderItem.`itemID`</code>&#010 if column quoting
 is enabled for that database (it generally isn't required, since MySQL &#010 preserves case by default).
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><CODE>com.smartgwt.client.docs.serverds.OperationBinding#selectClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#tableClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#whereClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#groupClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#orderClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#valuesClause</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#customSQL</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#customHQL</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#customValueFields</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#customCriteriaFields</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#excludeCriteriaFields</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#useForCacheSync</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#cacheSyncOperation</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#canSyncCache</CODE>, 
<CODE>com.smartgwt.client.docs.serverds.OperationBinding#sqlType</CODE>, 
<CODE>com.smartgwt.client..DefaultQueryClause</CODE>, 
<CODE>com.smartgwt.client..SQLType</CODE></DL>
<HR>

<P>

<P>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../com/smartgwt/client/docs/Cursor.html" title="interface in com.smartgwt.client.docs"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../com/smartgwt/client/docs/Data.html" title="interface in com.smartgwt.client.docs"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?com/smartgwt/client/docs/CustomQuerying.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CustomQuerying.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;METHOD</FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;METHOD</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
